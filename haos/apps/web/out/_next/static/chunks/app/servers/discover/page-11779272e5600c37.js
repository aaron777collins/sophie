(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[873],{6763:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>h});var r=a(14034),t=a(86042),l=a(9063);let o=(0,a(81551).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var c=a(11922),i=a(91399),n=a(73887),d=a(35262),x=a(40221),m=a(79761);function h(){let e=(0,l.useRouter)(),[s,a]=(0,t.useState)(""),[h,u]=(0,t.useState)("all"),[g,b]=(0,t.useState)(null),[y,v]=(0,t.useState)([]),[p,j]=(0,t.useState)(!1),[f,N]=(0,t.useState)(null),[w,C]=(0,t.useState)(1),[k,_]=(0,t.useState)("members"),[S,L]=(0,t.useState)("desc"),[M,A]=(0,t.useState)(0),{client:E,getPublicRooms:P}=(0,m.W)();(0,t.useEffect)(()=>{E&&F()},[E,s,w]);let F=async()=>{if(E){j(!0),N(null);try{let e=(w-1)*20,a=await P({limit:20,since:e>0?"offset_".concat(e):void 0,filter:{generic_search_term:s||void 0}}),r=a.chunk||[];v(r),A(a.total_room_count_estimate||r.length)}catch(e){console.error("Failed to load public rooms:",e),N("Failed to load servers. Please try again.")}finally{j(!1)}}},z=(0,t.useMemo)(()=>{let e=y.filter(e=>{var a,r,t,l,o;let c=!s||(null==(a=e.name)?void 0:a.toLowerCase().includes(s.toLowerCase()))||(null==(r=e.topic)?void 0:r.toLowerCase().includes(s.toLowerCase()))||(null==(t=e.canonical_alias)?void 0:t.toLowerCase().includes(s.toLowerCase())),i="all"===h||null!=(o=null==(l=e.topic)?void 0:l.toLowerCase().includes(h.toLowerCase()))&&o;return c&&i});return e.sort((e,s)=>{let a,r;switch(k){case"members":case"recent":a=e.num_joined_members,r=s.num_joined_members;break;case"name":a=(e.name||e.canonical_alias||e.room_id).toLowerCase(),r=(s.name||s.canonical_alias||s.room_id).toLowerCase();break;default:return 0}return"string"==typeof a?"asc"===S?a.localeCompare(r):r.localeCompare(a):"asc"===S?a-r:r-a}),e},[y,s,h,k,S]),J=async e=>{try{console.log("Joining server:",e)}catch(e){console.error("Failed to join server:",e)}},O=()=>{C(1),F()},q=e=>{e===k?L("asc"===S?"desc":"asc"):(_(e),L("desc"))},B=Math.ceil(M/20);return(0,r.jsxs)("div",{className:"min-h-screen bg-discord-dark",children:[(0,r.jsx)("header",{className:"bg-discord-darker border-b border-gray-700 sticky top-0 z-10",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>e.back(),className:"p-2 hover:bg-gray-700 rounded-lg transition-colors text-gray-400 hover:text-white","aria-label":"Go back",children:(0,r.jsx)(o,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center",children:(0,r.jsx)(c.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Discover Matrix Servers"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Browse and join public Matrix spaces and rooms"})]})]})]})})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-140px)]",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 flex flex-col bg-discord-light rounded-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-700 space-y-4",children:[(0,r.jsx)(n.e,{query:s,onQueryChange:a,onSearch:O,loading:p}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(d.b,{selectedCategory:h,onCategoryChange:u,rooms:y})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Sort by:"}),(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsxs)("button",{onClick:()=>q("members"),className:"px-3 py-1.5 text-sm rounded transition-colors ".concat("members"===k?"bg-primary-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:["Members ","members"===k&&("desc"===S?"↓":"↑")]}),(0,r.jsxs)("button",{onClick:()=>q("name"),className:"px-3 py-1.5 text-sm rounded transition-colors ".concat("name"===k?"bg-primary-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:["Name ","name"===k&&("desc"===S?"↓":"↑")]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[(0,r.jsxs)("span",{children:[p?"Loading...":"".concat(z.length," servers found"),M>y.length&&" (".concat(M," total)")]}),B>1&&(0,r.jsxs)("span",{children:["Page ",w," of ",B]})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:f?(0,r.jsxs)("div",{className:"p-6 text-center",children:[(0,r.jsx)("div",{className:"text-discord-red mb-2",children:f}),(0,r.jsx)("button",{onClick:O,className:"discord-button-secondary",children:"Try Again"})]}):(0,r.jsx)(i.e,{rooms:z,loading:p,selectedServer:g,onServerSelect:b})}),B>1&&!p&&(0,r.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:()=>C(Math.max(1,w-1)),disabled:1===w,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600 transition-colors",children:"Previous"}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:Array.from({length:Math.min(5,B)},(e,s)=>{let a=w<=3?s+1:w-2+s;return a<=B?(0,r.jsx)("button",{onClick:()=>C(a),className:"px-3 py-1.5 rounded transition-colors ".concat(a===w?"bg-primary-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:a},a):null})}),(0,r.jsx)("button",{onClick:()=>C(Math.min(B,w+1)),disabled:w===B,className:"px-4 py-2 bg-gray-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600 transition-colors",children:"Next"})]})})]}),(0,r.jsx)("div",{className:"bg-discord-light rounded-lg overflow-hidden",children:(0,r.jsx)(x.U,{server:g,onJoin:J})})]})})]})}},69509:(e,s,a)=>{Promise.resolve().then(a.bind(a,6763))}},e=>{e.O(0,[796,475,357,42,292,760,358],()=>e(e.s=69509)),_N_E=e.O()}]);