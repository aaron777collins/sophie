# 2026-02-09 — Matrix Server Deployment

## Session Times
- **~13:56 EST** - Matrix setup on dev2

---

## Matrix Server Setup (~13:56-14:05 EST)

Aaron requested setup of Matrix ecosystem on dev2.aaroncollins.info based on prior research discussion.

### What Was Deployed
- **Synapse** (Matrix homeserver) with PostgreSQL backend
- **Element Web** (client interface)
- **Coturn** (TURN server for video/voice calls)
- **Caddy** integration for SSL and routing

### Key Decisions
- Used existing Caddy reverse proxy instead of adding nginx
- Connected Caddy to Matrix Docker network for container DNS
- PostgreSQL 16 for production database
- TURN server on host network for NAT traversal

### Outcome
✅ All services healthy and accessible at https://dev2.aaroncollins.info

---

## Password Change (~15:14 EST)

Aaron requested password change for Matrix account:
- Old: `Matrix2026!Admin`
- New: `InTheMatrix2026!Admin`

Used Matrix client API with UIA flow to update.

---

---

## Invite-Only Registration (~17:22 EST)

Aaron requested invite-only registration instead of open signup.

### What Was Done
1. Enabled `registration_requires_token: true` in Synapse config
2. Created `~/matrix/invite` script to generate registration tokens
3. Script uses Synapse Admin API with Aaron's admin credentials
4. Tokens are single-use by default, configurable uses and expiry

### Usage
```bash
~/matrix/invite              # 1 use, 7 days
~/matrix/invite 5            # 5 uses, 7 days  
~/matrix/invite 20 30        # 20 uses, 30 days
```

### Token Generated
- `nmuCskdy5S3dIcaG` — 20 uses, expires 2026-03-11

---

## Self-Hosted Video Calling (~19:15 EST)

Aaron requested fully self-hosted video instead of using Element's hosted infrastructure.

### What Was Deployed
- **LiveKit** — WebRTC SFU for video/audio streaming
- **Element Call** — Video call UI frontend

### DNS Added (by Aaron)
- `livekit.dev2.aaroncollins.info` → 15.204.224.86
- `call.dev2.aaroncollins.info` → 15.204.224.86

### Configuration
- LiveKit API key: `devkey`
- LiveKit ports: 7880, 7881, 7882, 50000-50100
- Element configured to use self-hosted Element Call

### Outcome
✅ All video traffic now stays on Aaron's server

---

## Memory Created/Updated
- `memory/projects/matrix-dev2.md` - Full deployment documentation + invite system + video calling
